<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="9/9/2019 5:03:05 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="INV060333"
  DTS:CreatorName="OCDE\AurélieAtta"
  DTS:DTSID="{5BFC5080-699B-406C-A448-E160A4BF65BA}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.132"
  DTS:LocaleID="1033"
  DTS:ObjectName="OCDE_DWH_Location_DM"
  DTS:PackageType="5"
  DTS:VersionBuild="66"
  DTS:VersionGUID="{1D92F3F8-66C9-444C-B9E8-A9A6C151A396}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\TSQL INSERT INTO DWH_Location_DM"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{48A83E18-B292-4A9C-B9CC-AFFAFB550590}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TSQL INSERT INTO DWH_Location_DM"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B0DC49FE-B31E-4725-AD3B-5BB1D1A9DFE8}"
          SQLTask:SqlStatementSource="IF NOT EXISTS (&#xA;select C.City_ID,A.Country_ID&#xA;from [dwh].[Location_DM] A&#xA;inner join dwh.Country_DM B&#xA;on A.Country_ID=B.Country_ID&#xA;inner join dwh.City_DM C &#xA;ON A.City_ID=C.City_ID&#xA;WHERE B.[Country_Code] = 'Unknown' &#xA;AND C.[City] = 'Unknown')&#xA;BEGIN&#xA;&#xA;Declare @locationId int, @cityId int, @countryId int&#xA;select @cityId = City_ID from [dwh].[City_DM] where [City] = 'Unknown'&#xA;select @countryId = Country_ID from [dwh].[Country_DM] where [Country_Code] = 'Unknown'&#xA;INSERT INTO [dwh].[Location_DM]&#xA;           ([City_ID]&#xA;           ,[Country_ID]&#xA;           ,[LastUpdate_Date]&#xA;           ,[HideInReport]&#xA;           ,[NA_Import]&#xA;           ,[IsCurrent]&#xA;           ,[ValidFrom])&#xA;     VALUES&#xA;           (@cityId&#xA;           ,@countryId&#xA;           ,GETDATE()&#xA;           ,0&#xA;           ,0&#xA;           ,1&#xA;           ,GETDATE())&#xA;&#xA;END&#xA;&#xA;INSERT INTO [dwh].[Location_DM]&#xA;               ([City_ID]&#xA;               ,[Country_ID]&#xA;               ,[LastUpdate_Date]&#xA;               ,[HideInReport]&#xA;               ,[NA_Import]&#xA;               ,[IsCurrent]&#xA;               ,[ValidFrom]&#xA;               ,[ValidTo]&#xA;               ,[Proxy_ID])&#xA;        SELECT     T.[City_ID]&#xA;                ,T.[Country_ID]        &#xA;                ,GETDATE()        &#xA;                ,0                &#xA;                ,0               &#xA;                ,1               &#xA;                ,GETDATE()        &#xA;                ,NULL            &#xA;                ,NULL            &#xA;        FROM (&#x9;&#x9;&#xA;select A.*&#xA;FROM stg.STG_Location_DM_SA A&#xA;INNER JOIN dwh.COUNTRY_DM B&#xA;ON a.country_Id=b.country_Id&#xA;INNER JOIN dwh.City_DM c&#xA;on a.city_Id = c.city_Id) T" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--Cette section CDATA contient des informations sur la disposition du package. Elle comprend des informations telles que les coordonnées (x,y), la largeur et la hauteur.-->
<!--Si vous modifiez manuellement cette section et commettez une erreur, vous pouvez la supprimer. -->
<!--Le package pourra toujours se charger normalement, mais les informations de disposition précédente seront perdues et le concepteur réorganisera automatiquement les éléments sur l'aire de conception.-->
<Objects
  Version="8">
  <!--Chaque nœud ci-dessous contiendra des propriétés qui n'affectent pas le comportement d'exécution.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph">
        <NodeLayout
          Size="265.333333333334,42.6666666666667"
          Id="Package\TSQL INSERT INTO DWH_Location_DM"
          TopLeft="29.9999999627471,183.499997553072" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>