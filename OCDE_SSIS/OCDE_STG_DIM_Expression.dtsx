<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="9/9/2019 5:03:05 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="INV060333"
  DTS:CreatorName="OCDE\AurélieAtta"
  DTS:DTSID="{EBB41C9D-E27E-48FC-A747-F3D3DAA67A99}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.132"
  DTS:LocaleID="1033"
  DTS:ObjectName="OCDE_STG_DIM_Expression"
  DTS:PackageType="5"
  DTS:VersionBuild="73"
  DTS:VersionGUID="{7B8827C2-3A97-4FAB-BABC-B15CE034D55E}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="Azure_OCDE_STG"
      DTS:CreationName="Microsoft.LogProviderSQLServer"
      DTS:Description="Writes log entries for events to a SQL Server database"
      DTS:DTSID="{FB899C93-EA25-4917-93DF-95DDFA603C86}"
      DTS:ObjectName="SSIS log provider for SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:Variables />
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{FB899C93-EA25-4917-93DF-95DDFA603C86}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Truncate STG_Expression_DM_SSAS_Data"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tâche d'exécution de requêtes SQL"
      DTS:DTSID="{E408CA43-55A9-4463-B5EE-9C340102A69E}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Truncate STG_Expression_DM_SSAS_Data"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0"
        DTS:LoggingMode="1">
        <DTS:Property
          DTS:DataType="8"
          DTS:Name="EventFilter">3,7,OnError,13,OnPostExecute,12,OnPreExecute</DTS:Property>
        <DTS:Property
          DTS:EventName="OnError"
          DTS:Name="ColumnFilter">
          <DTS:Property
            DTS:Name="Computer">-1</DTS:Property>
          <DTS:Property
            DTS:Name="Operator">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceName">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="ExecutionID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="MessageText">-1</DTS:Property>
          <DTS:Property
            DTS:Name="DataBytes">-1</DTS:Property>
        </DTS:Property>
        <DTS:Property
          DTS:EventName="OnPostExecute"
          DTS:Name="ColumnFilter">
          <DTS:Property
            DTS:Name="Computer">-1</DTS:Property>
          <DTS:Property
            DTS:Name="Operator">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceName">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="ExecutionID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="MessageText">-1</DTS:Property>
          <DTS:Property
            DTS:Name="DataBytes">-1</DTS:Property>
        </DTS:Property>
        <DTS:Property
          DTS:EventName="OnPreExecute"
          DTS:Name="ColumnFilter">
          <DTS:Property
            DTS:Name="Computer">-1</DTS:Property>
          <DTS:Property
            DTS:Name="Operator">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceName">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="ExecutionID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="MessageText">-1</DTS:Property>
          <DTS:Property
            DTS:Name="DataBytes">-1</DTS:Property>
        </DTS:Property>
        <DTS:SelectedLogProviders>
          <DTS:SelectedLogProvider
            DTS:InstanceID="{FB899C93-EA25-4917-93DF-95DDFA603C86}" />
        </DTS:SelectedLogProviders>
      </DTS:LoggingOptions>
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B0DC49FE-B31E-4725-AD3B-5BB1D1A9DFE8}"
          SQLTask:SqlStatementSource="TRUNCATE TABLE stg.STG_Expression_DM_SSAS_Data" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\TSQL CREATE DWH_TMP_STG_Expression_DM_SSAS_Data"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{baab1b75-13c2-4841-a282-c31c0d65b569}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TSQL CREATE DWH_TMP_STG_Expression_DM_SSAS_Data"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B0DC49FE-B31E-4725-AD3B-5BB1D1A9DFE8}"
          SQLTask:SqlStatementSource="IF  EXISTS (SELECT * FROM sys.objects where name ='TMP_view_DIM_Expression_Metadata')&#xA;drop TABLE  [stg].[TMP_view_DIM_Expression_Metadata]&#xA;BEGIN&#xA;&#xA;CREATE TABLE [stg].[TMP_view_DIM_Expression_Metadata](&#xA;[Expression_ID]  [int] NOT null,&#xA;[CurExpId]  [int] NOT null,&#xA;[DOI][nvarchar](100) null,&#xA;[iLibraryURLAlias] [nvarchar](1054) null,&#xA;[iLibraryAccessMode] [tinyint] null,&#xA;[FirstRelease_Date] [datetime] null,&#xA;[FullTitle][nvarchar](4000) null,&#xA;[FirstExportDate] [datetime] null,&#xA;[LatestDeletionDate] [datetime] null,&#xA;[LatestExportDate] [datetime] null,&#xA;[Directorate_ID]  [int] NOT null,&#xA;[Language_ID]  [int] NOT null,&#xA;[Theme_ID]  [int] NOT null,&#xA;[Igo_ID]  [int] NOT null,&#xA;[ObjectType_ID]  [int] NOT null,&#xA;[ISSN] [nvarchar](20) null,&#xA;[TopParent_ID]  [int] null,&#xA;[Top2Parent_ID] [int] null,&#xA;[Top3Parent_ID] [int] null,&#xA;[HasEpub] [bit] null,&#xA;[HasEBook]  [bit] null,&#xA;[HasRead] [bit] null,&#xA;[HasHTML] [bit] null,&#xA;[HasExcel] [bit] null&#xA;) ON [PRIMARY]&#xA;END&#xA;&#xA;IF  EXISTS (SELECT * FROM sys.objects where name ='TMP_view_DIM_Directorate')&#xA;drop TABLE  [stg].[TMP_view_DIM_Directorate]&#xA;BEGIN&#xA;&#xA;CREATE TABLE [stg].[TMP_view_DIM_Directorate](&#xA;[Directorate_ID]  [int] NOT null,&#xA;[ID]  [int] NOT null,&#xA;[Directorate_ExternalID] [nvarchar](100) not null,&#xA;[ExternalSource] [nvarchar](10) not null,&#xA;[Directorate_Code] [nvarchar](4) not null,&#xA;[Directorate_Lib_EN] [nvarchar](150) not null,&#xA;[Directorate_Lib_FR] [nvarchar](150) not null&#xA;) ON [PRIMARY]&#xA;END" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\TSQL DROP DWH_TMP_STG_Expression_DM_SSAS_Data"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{a1af283a-175b-41ea-b364-95abda4acaaf}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TSQL DROP DWH_TMP_STG_Expression_DM_SSAS_Data"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B0DC49FE-B31E-4725-AD3B-5BB1D1A9DFE8}"
          SQLTask:SqlStatementSource="IF  EXISTS (SELECT * FROM sys.objects where name ='TMP_view_DIM_Directorate')&#xA;DROP TABLE [stg].[TMP_view_DIM_Directorate]&#xA;GO&#xA;&#xA;IF  EXISTS (SELECT * FROM sys.objects where name ='TMP_view_DIM_Expression_Metadata')&#xA;DROP TABLE [stg].[TMP_view_DIM_Expression_Metadata]&#xA;GO&#xA;&#xA;&#x9;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\TSQL INSERT INTO STG_Expression_DM_SSAS_Data"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tâche d'exécution de requêtes SQL"
      DTS:DTSID="{4FCBF9E1-EBA2-4D3A-B386-A78AE22D9AE7}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TSQL INSERT INTO STG_Expression_DM_SSAS_Data"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B0DC49FE-B31E-4725-AD3B-5BB1D1A9DFE8}"
          SQLTask:SqlStatementSource="&#xA;INSERT INTO  [stg].[STG_Expression_DM_SSAS_Data]( [CurExpId]&#xA;      ,[Expression - ID]&#xA;      ,[Expression - DOI]&#xA;      ,[Expression - FullTitle]&#xA;      ,[Expression - iLibraryURLAlias]&#xA;      ,[Expression - iLibraryAccessMode]&#xA;      ,[Expression - Directorate ID]&#xA;      ,[Expression - Language ID]&#xA;      ,[Expression - Theme ID]&#xA;      ,[Expression - IGO ID]&#xA;      ,[Expression - Object Type ID]&#xA;      ,[Expression - FirstRelease_Date]&#xA;      ,[Expression - FirstExportDate]&#xA;      ,[Expression - LatestDeletionDate]&#xA;      ,[Expression - LatestExportDate]&#xA;      ,[Expression - Object Type Level1]&#xA;      ,[Expression - Object Type Level2]&#xA;      ,[Expression - Title Level1]&#xA;      ,[Expression - Title Level2]&#xA;      ,[Expression - DOI Level1]&#xA;      ,[Expression - DOI Level2]&#xA;      ,[Expression - Theme Level1]&#xA;      ,[Expression - Theme Level2]&#xA;      ,[Expression - Directorate Code Level1]&#xA;      ,[Expression - Directorate Code Level2]&#xA;      ,[Expression - Directorate Name Level1]&#xA;      ,[Expression - Directorate Name Level2]&#xA;      ,[Expression - HasEpub]&#xA;      ,[Expression - HasEBook]&#xA;      ,[Expression - HasRead]&#xA;      ,[Expression - HasHTML]&#xA;      ,[Expression - HasExcel])&#xA;  &#xA;  SELECT  DISTINCT&#xA;Expression.CurExpId,Expression.Expression_ID AS [Expression - ID], Expression.DOI AS [Expression - DOI], &#xA;Expression.FullTitle AS [Expression - FullTitle], Expression.iLibraryURLAlias AS [Expression - iLibraryURLAlias],&#xA;Expression.iLibraryAccessMode AS [Expression - iLibraryAccessMode],Expression.Directorate_ID AS [Expression - Directorate ID],&#xA;Expression.Language_ID AS [Expression - Language ID], Expression.Theme_ID AS [Expression - Theme ID],&#xA;Expression.Igo_ID AS [Expression - IGO ID], Expression.ObjectType_ID AS [Expression - Object Type ID] ,                    &#xA;Expression.FirstRelease_Date AS [Expression - FirstRelease_Date],Expression.FirstExportDate AS [Expression - FirstExportDate],&#xA;Expression.LatestDeletionDate AS [Expression - LatestDeletionDate],Expression.LatestExportDate AS [Expression - LatestExportDate],&#xA;&#xA;CASE &#xA;  WHEN &#xA;         OBJ1.ObjectType_ExternalID IN &#xA;('5','6', '1101', '1102','7','8', '1203','9', '1205','14','4', '1201','3','1204','1104',&#xA;'1106', '1107', 'WorkingPaper Serie', '1204', '1105','1001','17', '1002','16','1003','1004') &#xA;OR charindex('[SUB]',OBJ1.ObjectType_Lib_EN)&gt;0&#xA; THEN OBJ1.ObjectType_Lib_EN WHEN &#xA;OBJ1.ObjectType_Lib_EN IS NULL AND OBJ2.ObjectType_ExternalID IS NOT NULL                                                                                                                                          &#xA;THEN OBJ2.ObjectType_Lib_EN WHEN &#xA;OBJ1.ObjectType_Lib_EN IS NULL AND (OBJ0.ObjectType_ExternalID IN &#xA;('5','6', '1101', '1102','7','8', '1203','9', '1205','14','4','1201','3', &#xA;'1204','1104', '1106', '1107', 'WorkingPaper Serie', &#xA;'1204','1105','1001','17', '1002','16', '1003','1004') &#xA;OR charindex('[SUB]',OBJ0.ObjectType_Lib_EN)&gt;0)                                                                                     &#xA;THEN  OBJ0.ObjectType_Lib_EN WHEN OBJ1.ObjectType_ExternalID IN &#xA;('212', '1306','1310' )&#xA;THEN OBJ1.ObjectType_Lib_EN &#xA;ELSE OBJ0.ObjectType_Lib_EN &#xA;END AS [Expression - Object Type Level1],&#xA; CASE &#xA; WHEN TopExpression.FullTitle =Top2Expression.FullTitle AND TopExpression.FullTitle IS NOT NULL &#xA;THEN  OBJ0.ObjectType_Lib_EN  ELSE&#xA;CASE &#xA;WHEN Top2Expression.FullTitle IS NOT NULL &#xA;THEN OBJ2.ObjectType_Lib_EN  ELSE OBJ0.ObjectType_Lib_EN  END&#xA; END AS [Expression - Object Type Level2],&#xA; CASE &#xA; WHEN OBJ1.ObjectType_ExternalID IN &#xA;('5','6', '1101', '1102', '7', '8', '1203','9', '1205','14', &#xA;'4', '1201','3','1204', '1104', '1106', '1107', 'WorkingPaper Serie', &#xA;'1204', '1105','1001','17', '1002','16','1003','1004') &#xA;OR charindex('[SUB]',OBJ1.ObjectType_Lib_EN)&gt;0&#xA;THEN TopExpression.FullTitle &#xA;WHEN OBJ1.ObjectType_Lib_EN IS NULL AND (OBJ0.ObjectType_ExternalID IN &#xA;( '5','6', '1101', '1102','7','8', '1203','9', '1205','14','4', '1201', &#xA;'3', '1204', '1104', '1106', '1107', 'WorkingPaper Serie', '1204', &#xA;'1105','1001','17', '1002','16', '1003','1004' ) &#xA;OR charindex('[SUB]',OBJ0.ObjectType_Lib_EN)&gt;0)                                                         &#xA;THEN Expression.FullTitle ELSE      &#xA;CASE &#xA;WHEN  TopExpression.FullTitle IS NOT NULL THEN TopExpression.FullTitle &#xA;ELSE Expression.FullTitle END&#xA;END AS [Expression - Title Level1],&#xA;CASE &#xA;WHEN TopExpression.DOI = Top2Expression.DOI AND TopExpression.DOI IS NOT NULL &#xA;THEN Expression.FullTitle  ELSE&#xA;CASE &#xA;WHEN Top2Expression.FullTitle IS NOT NULL &#xA;THEN Top2Expression.FullTitle  ELSE Expression.FullTitle END&#xA;END AS [Expression - Title Level2],&#xA;CASE &#xA;WHEN OBJ1.ObjectType_ExternalID IN &#xA;('5','6','1101', '1102','7','8', '1203', '9', '1205', &#xA;'14','4','1201','3','1204','1104', '1106', '1107', 'WorkingPaper Serie', &#xA; '1204','1105','1001', '17', '1002', '16', '1003', '1004') &#xA; OR charindex('[SUB]',OBJ1.ObjectType_Lib_EN)&gt;0&#xA;THEN TopExpression.DOI &#xA;WHEN OBJ1.ObjectType_Lib_EN IS NULL AND (OBJ0.ObjectType_ExternalID IN &#xA;('5','6', '1101', '1102','7','8', '1203','9', '1205', &#xA;'14', '4','1201','3','1204','1104','1106','1107', 'WorkingPaper Serie', &#xA;'1204','1105','1001','17', '1002','16', '1003','1004') &#xA;OR charindex('[SUB]',OBJ0.ObjectType_Lib_EN)&gt;0)                                                                                     &#xA;THEN Expression.DOI ELSE&#xA;CASE &#xA;WHEN TopExpression.DOI IS NOT NULL THEN TopExpression.DOI&#xA;ELSE Expression.DOI  END&#xA;END AS [Expression - DOI Level1],           &#xA;              CASE  WHEN  TopExpression.DOI = Top2Expression.DOI AND &#xA;                                          TopExpression.DOI IS NOT NULL&#xA;                            THEN Expression.DOI &#xA;                            ELSE     CASE WHEN  Top2Expression.DOI IS NOT NULL &#xA;                                                         THEN Top2Expression.DOI &#xA;                                                         ELSE Expression.DOI &#xA;                                          END&#xA;              END AS [Expression - DOI Level2],&#xA;              CASE &#xA;                            WHEN OBJ1.ObjectType_ExternalID IN &#xA;                                          (&#xA;        '5',  '6', '1101', '1102', '7', '8', '1203',  '9', '1205', '14',  '4', '1201',  '3', '1204', '1104',&#xA;                            '1106', '1107', 'WorkingPaper Serie', '1204','1105',  '1001',  '17', '1002',  '16', '1003','1004' &#xA;                                          ) &#xA;                                          OR charindex('[SUB]',OBJ1.ObjectType_Lib_EN)&gt;0                                                                                     &#xA;                            THEN TH1.Theme_Lib_EN&#xA;                            WHEN &#xA;                                          OBJ1.ObjectType_Lib_EN IS NULL AND &#xA;                                          (OBJ0.ObjectType_ExternalID IN &#xA;                                                         (&#xA;         '5',  '6', '1101', '1102', '7',  '8', '1203', '9', '1205',  '14',  '4', '1201',  '3',  '1204', &#xA;         '1104', '1106', '1107', 'WorkingPaper Serie',  '1204', '1105',  '1001', '17', '1002',  '16', '1003',   '1004' &#xA;                                                         ) &#xA;                                          OR charindex('[SUB]',OBJ0.ObjectType_Lib_EN)&gt;0)                            &#xA;                            THEN TH0.Theme_Lib_EN &#xA;                            ELSE CASE   WHEN  TopExpression.FullTitle IS NOT NULL &#xA;                                                         THEN TH1.Theme_Lib_EN &#xA;                                                         ELSE TH0.Theme_Lib_EN&#xA;                                          END&#xA;              END AS [Expression - Theme Level1],&#xA;              CASE &#xA;                            WHEN &#xA;                                          TopExpression.FullTitle = Top2Expression.FullTitle AND &#xA;                                          TopExpression.FullTitle IS NOT NULL &#xA;                            THEN TH0.Theme_Lib_EN &#xA;                            ELSE CASE  WHEN  Top2Expression.FullTitle IS NOT NULL &#xA;                                                         THEN TH2.Theme_Lib_EN &#xA;                                                         ELSE TH0.Theme_Lib_EN &#xA;                                          END&#xA;              END AS [Expression - Theme Level2],&#xA;              CASE &#xA;                            WHEN &#xA;                                          OBJ1.ObjectType_ExternalID IN &#xA;                                          (&#xA;       '5', '6', '1101', '1102', '7',  '8', '1203',  '9', '1205',  '14',  '4', '1201',  '3',  '1204',&#xA;       '1104', '1106', '1107', 'WorkingPaper Serie',  '1204', '1105', '1001',  '17', '1002',  '16', '1003', '1004' &#xA;                                          ) &#xA;                                          OR charindex('[SUB]',OBJ1.ObjectType_Lib_EN)&gt;0&#xA;                            THEN D1.Directorate_Code&#xA;                            WHEN &#xA;                                          OBJ1.ObjectType_Lib_EN IS NULL AND &#xA;                                          (OBJ0.ObjectType_ExternalID IN &#xA;                                                         (&#xA;     '5',  '6', '1101', '1102',  '7',  '8', '1203','9', '1205', '14', '4', '1201',  '3', '1204', &#xA;     '1104', '1106', '1107', 'WorkingPaper Serie','1204', '1105', '1001',  '17', '1002',  '16', '1003',  '1004' &#xA;                                                         ) &#xA;                                          OR charindex('[SUB]',OBJ0.ObjectType_Lib_EN)&gt;0)              &#xA;                            THEN D0.Directorate_Code &#xA;                            ELSE CASE  WHEN   D1.Directorate_Code IS NOT NULL &#xA;                                                         THEN D1.Directorate_Code &#xA;                                                         ELSE D0.Directorate_Code &#xA;                                          END&#xA;              END AS [Expression - Directorate Code Level1],&#xA;              CASE &#xA;                            WHEN &#xA;                                          TopExpression.FullTitle = Top2Expression.FullTitle &#xA;                                          AND TopExpression.FullTitle IS NOT NULL &#xA;                            THEN D0.Directorate_Code &#xA;                            ELSE CASE  WHEN  D1.Directorate_Code IS NOT NULL &#xA;                                                         THEN D1.Directorate_Code &#xA;                                                         ELSE D0.Directorate_Code END&#xA;              END AS [Expression - Directorate Code Level2],&#xA;              CASE &#xA;                            WHEN&#xA;                                          OBJ1.ObjectType_ExternalID IN &#xA;                                          (&#xA;    '5', '6', '1101', '1102', '7', '8', '1203',  '9', '1205', '14', '4', '1201','3', '1204', &#xA;    '1104', '1106', '1107', 'WorkingPaper Serie', '1204','1105', '1001', '17', '1002', '16', '1003', '1004' &#xA;                                          ) &#xA;                                          OR charindex('[SUB]',OBJ1.ObjectType_Lib_EN)&gt;0&#xA;                            THEN D1.Directorate_Lib_EN&#xA;                            WHEN &#xA;                                          OBJ1.ObjectType_Lib_EN IS NULL AND &#xA;                                          (OBJ0.ObjectType_ExternalID IN &#xA;                                                         (&#xA;    '5', '6', '1101', '1102', '7', '8', '1203', '9', '1205', '14','4', '1201', '3',  '1204',&#xA;    '1104', '1106', '1107', 'WorkingPaper Serie', '1204', '1105', '1001', '17', '1002', '16', '1003', '1004'  &#xA;                                                         ) &#xA;                                          OR charindex('[SUB]',OBJ0.ObjectType_Lib_EN)&gt;0)                                                         &#xA;                            THEN D0.Directorate_Lib_EN &#xA;                            ELSE CASE WHEN TopExpression.FullTitle IS NOT NULL &#xA;                                                         THEN D1.Directorate_Lib_EN &#xA;                                                         ELSE D0.Directorate_Lib_EN &#xA;                                          END&#xA;              END AS [Expression - Directorate Name Level1],&#xA;              CASE &#xA;                            WHEN &#xA;                                          TopExpression.FullTitle = Top2Expression.FullTitle AND &#xA;                                          TopExpression.FullTitle IS NOT NULL &#xA;                            THEN D0.Directorate_Lib_EN &#xA;                            ELSE        CASE        WHEN    Top2Expression.FullTitle IS NOT NULL &#xA;                                                         THEN D1.Directorate_Lib_EN &#xA;                                                         ELSE D0.Directorate_Lib_EN&#xA;                                          END&#xA;              END AS [Expression - Directorate Name Level2],&#xA;Expression.HasEpub AS [Expression - HasEpub], Expression.HasEBook AS [Expression - HasEBook],&#xA;Expression.HasRead AS [Expression - HasRead],Expression.HasHTML AS [Expression - HasHTML],&#xA;Expression.HasExcel AS [Expression - HasExcel]&#xA;&#xA;FROM &#xA;              stg.[TMP_view_DIM_Expression_Metadata] AS Expression &#xA;              LEFT OUTER JOIN (select Directorate_ID,Theme_ID,ObjectType_ID,Expression_ID,FullTitle,TopParent_ID, doi from stg.TMP_view_DIM_Expression_Metadata) AS Top2Expression &#xA;                            ON Expression.Top2Parent_ID = Top2Expression.Expression_ID&#xA;              LEFT OUTER JOIN  (select ObjectType_ExternalID,ObjectType_ID,ObjectType_Lib_EN from [dwh].ObjectType_DM)  OBJ0 &#xA;                            on Expression.ObjectType_ID=OBJ0.ObjectType_ID&#xA;              LEFT OUTER JOIN  (select Directorate_ID,Theme_ID,ObjectType_ID,Expression_ID,FullTitle,TopParent_ID, doi from stg.TMP_view_DIM_Expression_Metadata)  AS TopExpression &#xA;                                         ON TopExpression.Expression_ID = &#xA;                            CASE&#xA;                                          WHEN Top2Expression.TopParent_ID IS NOT NULL&#xA;                                          AND Expression.Expression_ID != Top2Expression.TopParent_ID&#xA;                                          AND OBJ0.ObjectType_ExternalID NOT IN ('1604', '1605', '1601')&#xA;                                          THEN Top2Expression.TopParent_ID&#xA;                                          ELSE Expression.TopParent_ID&#xA;                            END&#xA;              &#xA;              LEFT OUTER JOIN (select ObjectType_ExternalID,ObjectType_ID,ObjectType_Lib_EN from [dwh].ObjectType_DM) OBJ1 &#xA;                            ON TopExpression.ObjectType_ID=OBJ1.ObjectType_ID&#xA;              LEFT OUTER JOIN (select ObjectType_ExternalID,ObjectType_ID,ObjectType_Lib_EN from [dwh].ObjectType_DM) OBJ2 &#xA;                            ON Top2Expression.ObjectType_ID=OBJ2.ObjectType_ID&#xA;              LEFT OUTER JOIN  (select Theme_ID,Theme_Lib_EN from [dwh].Theme_DM)  TH0 &#xA;                            ON Expression.Theme_ID=TH0.Theme_ID&#xA;              LEFT OUTER JOIN  (select Theme_ID,Theme_Lib_EN from [dwh].Theme_DM)  TH1 &#xA;                            ON TopExpression.Theme_ID=TH1.Theme_ID&#xA;              LEFT OUTER JOIN  (select Theme_ID,Theme_Lib_EN from [dwh].Theme_DM)  TH2 &#xA;                            ON Top2Expression.Theme_ID=TH2.Theme_ID&#xA;              LEFT OUTER JOIN (select Directorate_ID,Directorate_Lib_EN,Directorate_Code from stg.TMP_view_DIM_Directorate) D0 &#xA;                            ON Expression.Directorate_ID=D0.Directorate_ID&#xA;              LEFT OUTER JOIN (select Directorate_ID,Directorate_Lib_EN,Directorate_Code from stg.TMP_view_DIM_Directorate) D1 &#xA;                            ON TopExpression.Directorate_ID=D1.Directorate_ID&#xA;              LEFT OUTER JOIN (select Directorate_ID,Directorate_Lib_EN,Directorate_Code from stg.TMP_view_DIM_Directorate) D2 &#xA;                            ON Top2Expression.Directorate_ID=D2.Directorate_ID&#xA;WHERE &#xA;              Expression.DOI &lt;&gt; '' AND &#xA;              Expression.DOI IS NOT NULL" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\TSQL INSERT INTO TMP_STG_Expression_DM_SSAS_Data"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tâche d'exécution de requêtes SQL"
      DTS:DTSID="{F872D961-6A7C-48B3-8169-FDA2D813E39C}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TSQL INSERT INTO TMP_STG_Expression_DM_SSAS_Data"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B0DC49FE-B31E-4725-AD3B-5BB1D1A9DFE8}"
          SQLTask:SqlStatementSource="INSERT INTO stg.[TMP_view_DIM_Expression_Metadata](&#xA;[Expression_ID] ,&#xA;[CurExpId] ,&#xA;[DOI],&#xA;[iLibraryURLAlias] ,&#xA;[iLibraryAccessMode] ,&#xA;[FirstRelease_Date] ,&#xA;[FullTitle],&#xA;[FirstExportDate],&#xA;[LatestDeletionDate] ,&#xA;[LatestExportDate] ,&#xA;[Directorate_ID]  ,&#xA;[Language_ID]  ,&#xA;[Theme_ID]  ,&#xA;[Igo_ID]   ,&#xA;[ObjectType_ID]  ,&#xA;[ISSN] ,&#xA;[TopParent_ID]  ,&#xA;[Top2Parent_ID] ,&#xA;[Top3Parent_ID],&#xA;[HasEpub],&#xA;[HasEBook] ,&#xA;[HasRead] ,&#xA;[HasHTML] ,&#xA;[HasExcel]&#xA;) select * from stg.view_DIM_Expression_Metadata&#xA;&#xA;INSERT INTO [stg].[TMP_view_DIM_Directorate](&#xA;[Directorate_ID]  ,&#xA;[ID]  ,&#xA;[Directorate_ExternalID],&#xA;[ExternalSource] ,&#xA;[Directorate_Code] ,&#xA;[Directorate_Lib_EN] ,&#xA;[Directorate_Lib_FR] &#xA;) select * from stg.view_DIM_Directorate" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Contrainte]"
      DTS:CreationName=""
      DTS:DTSID="{7E806B74-544F-465C-A407-A2F94AEB43DF}"
      DTS:From="Package\Truncate STG_Expression_DM_SSAS_Data"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Contrainte"
      DTS:To="Package\TSQL CREATE DWH_TMP_STG_Expression_DM_SSAS_Data" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Contrainte 1]"
      DTS:CreationName=""
      DTS:DTSID="{133DB024-039D-4C57-9083-5210EACC55F2}"
      DTS:From="Package\TSQL CREATE DWH_TMP_STG_Expression_DM_SSAS_Data"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Contrainte 1"
      DTS:To="Package\TSQL INSERT INTO TMP_STG_Expression_DM_SSAS_Data" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Contrainte 2]"
      DTS:CreationName=""
      DTS:DTSID="{1E2EDB7A-59B0-49EC-9E65-15516DC45EE0}"
      DTS:From="Package\TSQL INSERT INTO TMP_STG_Expression_DM_SSAS_Data"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Contrainte 2"
      DTS:To="Package\TSQL INSERT INTO STG_Expression_DM_SSAS_Data" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Contrainte 3]"
      DTS:CreationName=""
      DTS:DTSID="{9DFBABAF-A0B3-49C8-A2DA-F72AA8CFF413}"
      DTS:From="Package\TSQL INSERT INTO STG_Expression_DM_SSAS_Data"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Contrainte 3"
      DTS:To="Package\TSQL DROP DWH_TMP_STG_Expression_DM_SSAS_Data" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--Cette section CDATA contient des informations sur la disposition du package. Elle comprend des informations telles que les coordonnées (x,y), la largeur et la hauteur.-->
<!--Si vous modifiez manuellement cette section et commettez une erreur, vous pouvez la supprimer. -->
<!--Le package pourra toujours se charger normalement, mais les informations de disposition précédente seront perdues et le concepteur réorganisera automatiquement les éléments sur l'aire de conception.-->
<Objects
  Version="8">
  <!--Chaque nœud ci-dessous contiendra des propriétés qui n'affectent pas le comportement d'exécution.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="278.666666666667,42.6666666666667"
          Id="Package\Truncate STG_Expression_DM_SSAS_Data"
          TopLeft="46.1666666666667,5.49999999999993" />
        <NodeLayout
          Size="360,42.6666666666667"
          Id="Package\TSQL CREATE DWH_TMP_STG_Expression_DM_SSAS_Data"
          TopLeft="9.66666660457844,76.9666672245665" />
        <NodeLayout
          Size="349.333333333334,42.6666666666667"
          Id="Package\TSQL DROP DWH_TMP_STG_Expression_DM_SSAS_Data"
          TopLeft="17.499999900659,320.833335038027" />
        <NodeLayout
          Size="330,42.6666666666667"
          Id="Package\TSQL INSERT INTO STG_Expression_DM_SSAS_Data"
          TopLeft="27.9166662506754,243.033334363897" />
        <NodeLayout
          Size="356,42.6666666666667"
          Id="Package\TSQL INSERT INTO TMP_STG_Expression_DM_SSAS_Data"
          TopLeft="12.1388896442954,156.811112077104" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Contrainte]"
          TopLeft="187.583333302289,48.1666666666666">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,28.8000005578999"
              Start="0,0"
              End="0,21.3000005578999">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,21.3000005578999" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Contrainte 1]"
          TopLeft="189.902778124437,119.633333891233">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,37.1777781858706"
              Start="0,0"
              End="0,29.6777781858706">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,29.6777781858706" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Contrainte 2]"
          TopLeft="191.527777947485,199.47777874377">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,43.555555620127"
              Start="0,0"
              End="0,36.055555620127">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,36.055555620127" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Contrainte 3]"
          TopLeft="192.541666409001,285.700001030564">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,35.1333340074625"
              Start="0,0"
              End="0,27.6333340074625">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,27.6333340074625" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>