<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="9/9/2019 5:03:05 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="INV060333"
  DTS:CreatorName="OCDE\AurélieAtta"
  DTS:DTSID="{712774CD-88E2-4781-8497-D7E81FAAB2C3}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.2000.132"
  DTS:LocaleID="1033"
  DTS:ObjectName="OCDE_STG_GoogleBooksMonthly"
  DTS:PackageType="5"
  DTS:VersionBuild="77"
  DTS:VersionGUID="{D3FFF78A-0650-4F5C-A4EB-578C8E07D045}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:LogProviders>
    <DTS:LogProvider
      DTS:ConfigString="Azure_OCDE_STG"
      DTS:CreationName="Microsoft.LogProviderSQLServer"
      DTS:Description="Enregistre les entrées du journal pour les événements dans une base de données SQL Server"
      DTS:DTSID="{38B9B1DB-32A3-497D-A5BE-CF5C42E10345}"
      DTS:ObjectName="Module fournisseur d'informations SSIS pour SQL Server">
      <DTS:ObjectData>
        <InnerObject />
      </DTS:ObjectData>
    </DTS:LogProvider>
  </DTS:LogProviders>
  <DTS:Variables />
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1">
    <DTS:SelectedLogProviders>
      <DTS:SelectedLogProvider
        DTS:InstanceID="{38B9B1DB-32A3-497D-A5BE-CF5C42E10345}" />
    </DTS:SelectedLogProviders>
  </DTS:LoggingOptions>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\TSQL INSERT INTO STG_GoogleBooksMonthly"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tâche d'exécution de requêtes SQL"
      DTS:DTSID="{4E1F4428-1AC3-4316-B343-878FC36FD2FA}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TSQL INSERT INTO STG_GoogleBooksMonthly"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B0DC49FE-B31E-4725-AD3B-5BB1D1A9DFE8}"
          SQLTask:SqlStatementSource="INSERT stg.STG_GoogleBooksMonthly (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;[Download_Date]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[ISBN13]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[books_visits]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[BV_w_pages_viewed]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[pages_viewed]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[Manifestation_ID])&#xA;&#xA;&#x9;&#x9;&#x9;SELECT [File_Date] &#xA;&#x9;&#x9;&#x9;&#x9;  ,[Primary ISBN]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[BV]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[BVWPV]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[PV]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[Manifestation_ID]&#xA;&#x9;&#x9;&#x9;FROM [stg].[View_GoogleBooksMonthly_TMP_SA]&#xA;&#xA;&#xA;&#xA;&#xA;&#x9;&#x9;&#x9;INSERT [dwh].[GoogleBooksMonthly_Rejected](&#xA;&#x9;&#x9;&#x9;&#x9;   [Download_Date]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[ISBN13]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[books_visits]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[BV_w_pages_viewed]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[pages_viewed]&#xA;&#x9;&#x9;&#x9;&#x9;  &#xA;&#x9;&#x9;&#x9;&#x9;  )&#xA;&#x9;&#x9;&#x9;SELECT distinct [Download_Date]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[ISBN13]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[books_visits]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[BV_w_pages_viewed]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[pages_viewed] &#xA;&#x9;&#x9;&#x9;&#x9;  &#xA;&#x9;&#x9;&#x9;  FROM [stg].STG_GoogleBooksMonthly&#xA;&#x9;&#x9;&#x9;  where Manifestation_ID is null &#xA;&#x9;&#x9;&#x9;  &#xA;&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;INSERT [stg].[STG_GoogleBooksMonthly_SA]([Download_Date]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[ISBN13]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[books_visits]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[BV_w_pages_viewed]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[pages_viewed])&#xA;&#x9;&#x9;&#x9;SELECT  DISTINCT &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;[Download_Date]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[ISBN13]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[books_visits]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[BV_w_pages_viewed]&#xA;&#x9;&#x9;&#x9;&#x9;  ,[pages_viewed] &#xA;&#x9;&#x9;&#x9;  FROM [stg].STG_GoogleBooksMonthly&#xA;&#x9;&#x9;&#x9;   where Manifestation_ID is  not null " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\TSQL INSERT INTO STG_GoogleBooksMonthly_FT_SA"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tâche d'exécution de requêtes SQL"
      DTS:DTSID="{FE1F2926-96A3-4150-86D5-B67EA0E9A87B}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TSQL INSERT INTO STG_GoogleBooksMonthly_FT_SA"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B0DC49FE-B31E-4725-AD3B-5BB1D1A9DFE8}"
          SQLTask:SqlStatementSource="INSERT INTO [stg].[STG_GoogleBooksMonthly_FT_SA]( [Download_Date]&#xA;      ,[Expression_ID]&#xA;      ,[books_visits]&#xA;      ,[BV_w_pages_viewed]&#xA;      ,[pages_viewed])&#xA;  SELECT [Download_Date]&#xA;      ,[Expression_ID]&#xA;      ,[books_visits]&#xA;      ,[BV_w_pages_viewed]&#xA;      ,[pages_viewed]&#xA;  FROM [stg].[view_GoogleBooksMonthly_FT_SA] " xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\TSQL Truncate STG_GoogleBooksMonthly"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tâche d'exécution de requêtes SQL"
      DTS:DTSID="{9810599E-6C73-4F09-8CFC-FD6CEBC824C9}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TSQL Truncate STG_GoogleBooksMonthly"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0"
        DTS:LoggingMode="1">
        <DTS:Property
          DTS:DataType="8"
          DTS:Name="EventFilter">3,7,OnError,13,OnPostExecute,12,OnPreExecute</DTS:Property>
        <DTS:Property
          DTS:EventName="OnError"
          DTS:Name="ColumnFilter">
          <DTS:Property
            DTS:Name="Computer">-1</DTS:Property>
          <DTS:Property
            DTS:Name="Operator">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceName">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="ExecutionID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="MessageText">-1</DTS:Property>
          <DTS:Property
            DTS:Name="DataBytes">-1</DTS:Property>
        </DTS:Property>
        <DTS:Property
          DTS:EventName="OnPostExecute"
          DTS:Name="ColumnFilter">
          <DTS:Property
            DTS:Name="Computer">-1</DTS:Property>
          <DTS:Property
            DTS:Name="Operator">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceName">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="ExecutionID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="MessageText">-1</DTS:Property>
          <DTS:Property
            DTS:Name="DataBytes">-1</DTS:Property>
        </DTS:Property>
        <DTS:Property
          DTS:EventName="OnPreExecute"
          DTS:Name="ColumnFilter">
          <DTS:Property
            DTS:Name="Computer">-1</DTS:Property>
          <DTS:Property
            DTS:Name="Operator">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceName">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="ExecutionID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="MessageText">-1</DTS:Property>
          <DTS:Property
            DTS:Name="DataBytes">-1</DTS:Property>
        </DTS:Property>
        <DTS:SelectedLogProviders>
          <DTS:SelectedLogProvider
            DTS:InstanceID="{38B9B1DB-32A3-497D-A5BE-CF5C42E10345}" />
        </DTS:SelectedLogProviders>
      </DTS:LoggingOptions>
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B0DC49FE-B31E-4725-AD3B-5BB1D1A9DFE8}"
          SQLTask:SqlStatementSource="TRUNCATE TABLE stg.STG_GoogleBooksMonthly" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\TSQL Truncate STG_GoogleBooksMonthly_FT_SA"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tâche d'exécution de requêtes SQL"
      DTS:DTSID="{8fec4123-d74d-4af4-833f-2e545dcba86f}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TSQL Truncate STG_GoogleBooksMonthly_FT_SA"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0"
        DTS:LoggingMode="1" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B0DC49FE-B31E-4725-AD3B-5BB1D1A9DFE8}"
          SQLTask:SqlStatementSource="TRUNCATE TABLE stg.STG_GoogleBooksMonthly_FT_SA" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\TSQL Truncate STG_GoogleBooksMonthly_SA"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Tâche d'exécution de requêtes SQL"
      DTS:DTSID="{eec702c2-1f7f-4a61-ae70-b8a733770517}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="TSQL Truncate STG_GoogleBooksMonthly_SA"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0"
        DTS:LoggingMode="1" />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{B0DC49FE-B31E-4725-AD3B-5BB1D1A9DFE8}"
          SQLTask:SqlStatementSource="TRUNCATE TABLE stg.STG_GoogleBooksMonthly_SA" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Contrainte]"
      DTS:CreationName=""
      DTS:DTSID="{0E6C9702-F898-40A4-B658-286938207722}"
      DTS:From="Package\TSQL Truncate STG_GoogleBooksMonthly"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Contrainte"
      DTS:To="Package\TSQL Truncate STG_GoogleBooksMonthly_SA" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Contrainte 1]"
      DTS:CreationName=""
      DTS:DTSID="{2F888424-CDBF-4498-897E-7B26DFE65C2C}"
      DTS:From="Package\TSQL Truncate STG_GoogleBooksMonthly_SA"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Contrainte 1"
      DTS:To="Package\TSQL Truncate STG_GoogleBooksMonthly_FT_SA" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Contrainte 2]"
      DTS:CreationName=""
      DTS:DTSID="{3AF8441A-5A5D-483C-ABC6-B9D223F35A2C}"
      DTS:From="Package\TSQL Truncate STG_GoogleBooksMonthly_FT_SA"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Contrainte 2"
      DTS:To="Package\TSQL INSERT INTO STG_GoogleBooksMonthly" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Contrainte 3]"
      DTS:CreationName=""
      DTS:DTSID="{CC7AE8E1-83E0-49DA-B661-1C9CDDC09E5B}"
      DTS:From="Package\TSQL INSERT INTO STG_GoogleBooksMonthly"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Contrainte 3"
      DTS:To="Package\TSQL INSERT INTO STG_GoogleBooksMonthly_FT_SA" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--Cette section CDATA contient des informations sur la disposition du package. Elle comprend des informations telles que les coordonnées (x,y), la largeur et la hauteur.-->
<!--Si vous modifiez manuellement cette section et commettez une erreur, vous pouvez la supprimer. -->
<!--Le package pourra toujours se charger normalement, mais les informations de disposition précédente seront perdues et le concepteur réorganisera automatiquement les éléments sur l'aire de conception.-->
<Objects
  Version="8">
  <!--Chaque nœud ci-dessous contiendra des propriétés qui n'affectent pas le comportement d'exécution.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="298.666666666667,42.6666666666667"
          Id="Package\TSQL INSERT INTO STG_GoogleBooksMonthly"
          TopLeft="121.527775966873,370.055554044578" />
        <NodeLayout
          Size="334.666666666667,42.6666666666667"
          Id="Package\TSQL INSERT INTO STG_GoogleBooksMonthly_FT_SA"
          TopLeft="115.277776060005,559.666663593054" />
        <NodeLayout
          Size="276,42.6666666666667"
          Id="Package\TSQL Truncate STG_GoogleBooksMonthly"
          TopLeft="115.083331700415,102.533333434065" />
        <NodeLayout
          Size="312,42.6666666666667"
          Id="Package\TSQL Truncate STG_GoogleBooksMonthly_FT_SA"
          TopLeft="105.708331840113,251.816664098004" />
        <NodeLayout
          Size="294.666666666667,42.6666666666667"
          Id="Package\TSQL Truncate STG_GoogleBooksMonthly_SA"
          TopLeft="114.458331709729,176.199998783469" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Contrainte]"
          TopLeft="253.083331700415,145.200000100732">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="8.70833334264694,30.9999986827376"
              Start="0,0"
              End="8.70833334264694,23.4999986827376">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,11.4999993413688" />
                  <mssgle:CubicBezierSegment
                    Point1="0,11.4999993413688"
                    Point2="0,15.4999993413688"
                    Point3="4,15.4999993413688" />
                  <mssgle:LineSegment
                    End="4.70833334264694,15.4999993413688" />
                  <mssgle:CubicBezierSegment
                    Point1="4.70833334264694,15.4999993413688"
                    Point2="8.70833334264694,15.4999993413688"
                    Point3="8.70833334264694,19.4999993413688" />
                  <mssgle:LineSegment
                    End="8.70833334264694,23.4999986827376" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Contrainte 1]"
          TopLeft="261.749998441587,218.866665450136">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,32.9499986478681"
              Start="0,0"
              End="0,25.4499986478681">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,25.4499986478681" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Contrainte 2]"
          TopLeft="261.708331840113,294.483330764671">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="9.15277746009292,75.5722232799072"
              Start="0,0"
              End="9.15277746009292,68.0722232799072">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,33.7861116399536" />
                  <mssgle:CubicBezierSegment
                    Point1="0,33.7861116399536"
                    Point2="0,37.7861116399536"
                    Point3="4,37.7861116399536" />
                  <mssgle:LineSegment
                    End="5.15277746009292,37.7861116399536" />
                  <mssgle:CubicBezierSegment
                    Point1="5.15277746009292,37.7861116399536"
                    Point2="9.15277746009292,37.7861116399536"
                    Point3="9.15277746009292,41.7861116399536" />
                  <mssgle:LineSegment
                    End="9.15277746009292,68.0722232799072" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Contrainte 3]"
          TopLeft="270.861109300206,412.722220711245">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="11.750000093132,146.944442881809"
              Start="0,0"
              End="11.750000093132,139.444442881809">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,69.4722214409046" />
                  <mssgle:CubicBezierSegment
                    Point1="0,69.4722214409046"
                    Point2="0,73.4722214409046"
                    Point3="4,73.4722214409046" />
                  <mssgle:LineSegment
                    End="7.75000009313197,73.4722214409046" />
                  <mssgle:CubicBezierSegment
                    Point1="7.75000009313197,73.4722214409046"
                    Point2="11.750000093132,73.4722214409046"
                    Point3="11.750000093132,77.4722214409046" />
                  <mssgle:LineSegment
                    End="11.750000093132,139.444442881809" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>